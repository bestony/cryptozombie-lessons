---
title: ZBã‚«ã‚¹ã‚¿ãƒ ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã®åŸºç¤
actions: ["ç­”ãˆåˆã‚ã›", "ãƒ’ãƒ³ãƒˆ"]
requireLogin: false
material:
  editor:
    language: solidity
    startingCode:
      "examplegame.sol": |
        pragma solidity 0.4.25;

        import "./ZB/ZBGameMode.sol";

        contract ExampleGame is ZBGameMode  {

            // ã“ã“ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆã™ã‚‹ã®ã

        }
      "ZBGameMode.sol": |
        // ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯å‚ç…§ç”¨ã§ã™ãŒã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã«å¿…è¦ãªã‚¤ãƒ³ãƒãƒ¼ãƒˆå…¨ã¦ãŒå«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
        // æœ€çµ‚çš„ãªå…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã“ã¡ã‚‰ã«ã‚ã‚Šã¾ã™:
        // https://github.com/loomnetwork/zb_game_mode

        pragma solidity ^0.4.25;

        import "./ZBEnum.sol";
        import "./ZBSerializer.sol";

        contract ZBGameMode {
            using ZBSerializer for ZBSerializer.SerializedGameStateChanges;
            using ZBSerializer for GameState;

            enum Player {
                Player1,
                Player2
            }

            struct PlayerState {
                string id;
                //PlayerActionType currentAction = 2;
                //OverlordInstance overlordInstance = 3;
                CardInstance[] cardsInHand;
                //CardInstance[] CardsInPlay;
                CardInstance[] cardsInDeck;
                Deck deck;
                uint8 defense;
                uint8 currentGoo;
                uint8 gooVials;
                uint32 turnTime;
                //bool hasDrawnCard = 11;
                //repeated CardInstance cardsInGraveyard = 12;
                uint8 initialCardsInHandCount;
                uint8 maxCardsInPlay;
                uint8 maxCardsInHand;
                uint8 maxGooVials;
            }

            struct Deck {
                int64 id;
                string name;
                int64 heroId;
            }

            struct CardInstance {
                int32 instanceId;
                string mouldName;
                int32 defense;
                bool defenseInherited;
                int32 attack;
                bool attackInherited;
                int32 gooCost;
                bool gooCostInherited;
            }

            struct GameState {
                int64 id;
                uint8 currentPlayerIndex;
                PlayerState[] playerStates;
            }

            struct Vector2Int {
                int32 x;
                int32 y;
            }

            struct Rect {
                Vector2Int position;
                Vector2Int size;
            }

            struct CustomUiLabel {
                Rect rect;
                string text;
            }

            struct CustomUiButton {
                Rect rect;
                string title;
                bytes onClickCallData;
            }

            event GameStateChanges (
                bytes serializedChanges
            );

            function getInterfaceVersion() external pure returns (int) {
                return 1;
            }

            function getDataStructureVersion() external pure returns (int) {
                return 1;
            }

            function beforeMatchStart(bytes) external {
            }

            function afterInitialDraw(bytes) external {
            }

            function getCustomUi() external view returns (bytes) {
                return new bytes(0);
            }
        }
      "ZBSerializer.sol": |
        // ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯å‚ç…§ç”¨ã§ã™ãŒã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã«å¿…è¦ãªã‚¤ãƒ³ãƒãƒ¼ãƒˆå…¨ã¦ãŒå«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚
        // æœ€çµ‚çš„ãªå…¨ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã“ã¡ã‚‰ã«ã‚ã‚Šã¾ã™:
        // https://github.com/loomnetwork/zb_game_mode

        pragma solidity ^0.4.25;

        import "./ZBEnum.sol";
        import "./ZBGameMode.sol";
        import "./SerialityBinaryStream.sol";

        library ZBSerializer {
            using SerialityBinaryStream for SerialityBinaryStream.BinaryStream;
            uint constant defaultSerializedGameStateChangesBufferSize = 512;
            uint constant defaultSerializedCustomUiBufferSize = 512;

            event GameStateChanges (
                bytes serializedChanges
            );

            struct SerializedGameStateChanges {
                SerialityBinaryStream.BinaryStream stream;
            }

            struct SerializedCustomUi {
                SerialityBinaryStream.BinaryStream stream;
            }

            // GameState deserialization

            function init(ZBGameMode.GameState memory self, bytes serializedGameState) internal pure {
                SerialityBinaryStream.BinaryStream memory stream =
                    SerialityBinaryStream.BinaryStream(serializedGameState, serializedGameState.length);

                self.id = stream.readInt64();
                self.currentPlayerIndex = stream.readUint8();

                self.playerStates = new ZBGameMode.PlayerState[](2);
                for (uint i = 0; i < self.playerStates.length; i++) {
                    self.playerStates[i] = deserializePlayerState(stream);
                }
            }

            function deserializePlayerState(SerialityBinaryStream.BinaryStream memory stream) private pure returns (ZBGameMode.PlayerState) {
                ZBGameMode.PlayerState memory player;

                player.id = stream.readString();
                player.deck = deserializeDeck(stream);
                player.cardsInHand = deserializeCardInstanceArray(stream);
                player.cardsInDeck = deserializeCardInstanceArray(stream);
                player.defense = stream.readUint8();
                player.currentGoo = stream.readUint8();
                player.gooVials = stream.readUint8();
                player.turnTime = stream.readUint32();
                player.initialCardsInHandCount = stream.readUint8();
                player.maxCardsInPlay = stream.readUint8();
                player.maxCardsInHand = stream.readUint8();
                player.maxGooVials = stream.readUint8();

                return player;
            }

            function serializeCardInstance(SerialityBinaryStream.BinaryStream memory stream, ZBGameMode.CardInstance card) private pure {
                stream.writeInt32(card.instanceId);
                stream.writeString(card.mouldName);
                stream.writeInt32(card.defense);
                stream.writeBool(card.attackInherited);
                stream.writeInt32(card.attack);
                stream.writeBool(card.defenseInherited);
                stream.writeInt32(card.gooCost);
                stream.writeBool(card.gooCostInherited);
            }

            function deserializeCardInstance(SerialityBinaryStream.BinaryStream memory stream) private pure returns (ZBGameMode.CardInstance) {
                ZBGameMode.CardInstance memory card;

                card.instanceId = stream.readInt32();
                card.mouldName = stream.readString();
                card.defense = stream.readInt32();
                card.defenseInherited = stream.readBool();
                card.attack = stream.readInt32();
                card.attackInherited = stream.readBool();
                card.gooCost = stream.readInt32();
                card.gooCostInherited = stream.readBool();

                return card;
            }

            function serializeCardInstanceArray(SerialityBinaryStream.BinaryStream memory stream, ZBGameMode.CardInstance[] cards) internal pure {
                stream.writeUint32(uint32(cards.length));

                for (uint i = 0; i < cards.length; i++) {
                    serializeCardInstance(stream, cards[i]);
                }
            }

            function deserializeCardInstanceArray(SerialityBinaryStream.BinaryStream memory stream) private pure returns (ZBGameMode.CardInstance[]) {
                uint count = stream.readUint32();

                ZBGameMode.CardInstance[] memory cards = new ZBGameMode.CardInstance[](count);
                for (uint i = 0; i < count; i++) {
                    cards[i] = deserializeCardInstance(stream);
                }

                return cards;
            }

            function deserializeDeck(SerialityBinaryStream.BinaryStream memory stream) private pure returns (ZBGameMode.Deck) {
                ZBGameMode.Deck memory deck;
                deck.id = stream.readInt64();
                deck.name = stream.readString();
                deck.heroId = stream.readInt64();

                return deck;
            }

            function serializeStartGameStateChangeAction(
                SerialityBinaryStream.BinaryStream memory stream,
                ZBEnum.GameStateChangeAction action
                ) private pure {
                stream.writeUint32(uint32(action));
            }

            function serializeStartGameStateChangeAction(
                SerialityBinaryStream.BinaryStream memory stream,
                ZBEnum.GameStateChangeAction action,
                ZBGameMode.Player player
                ) private pure {
                stream.writeUint32(uint32(action));
                stream.writeUint8(uint8(player));
            }

            // CardInstance

            function changeMouldName(ZBGameMode.CardInstance memory self, string mouldName) internal pure {
                self.mouldName = mouldName;
            }

            function changeDefense(ZBGameMode.CardInstance memory self, uint8 defense) internal pure {
                self.defense = defense;
                self.defenseInherited = false;
            }

            function changeAttack(ZBGameMode.CardInstance memory self, uint8 attack) internal pure {
                self.attack = attack;
                self.attackInherited = false;
            }

            function changeGooCost(ZBGameMode.CardInstance memory self, uint8 gooCost) internal pure {
                self.gooCost = gooCost;
                self.gooCostInherited = false;
            }

            // SerializedGameStateChanges

            function init(SerializedGameStateChanges memory self) internal pure {
                init(self, defaultSerializedGameStateChangesBufferSize);
            }

            function init(SerializedGameStateChanges memory self, uint bufferSize) internal pure {
                self.stream = SerialityBinaryStream.BinaryStream(new bytes(bufferSize), bufferSize);
            }

            function getBytes(SerializedGameStateChanges memory self) internal pure returns (bytes) {
                return self.stream.buffer;
            }

            function emit(SerializedGameStateChanges memory self) internal {
                emit GameStateChanges(getBytes(self));
            }

            function changePlayerDefense(SerializedGameStateChanges memory self, ZBGameMode.Player player, uint8 defense) internal pure returns (uint) {
                SerialityBinaryStream.BinaryStream memory stream = self.stream;

                serializeStartGameStateChangeAction(stream, ZBEnum.GameStateChangeAction.SetPlayerDefense, player);
                stream.writeUint8(uint8(defense));
            }

            function changePlayerCurrentGoo(SerializedGameStateChanges memory self, ZBGameMode.Player player, uint8 currentGoo) internal pure {
                SerialityBinaryStream.BinaryStream memory stream = self.stream;

                serializeStartGameStateChangeAction(stream, ZBEnum.GameStateChangeAction.SetPlayerCurrentGoo, player);
                stream.writeUint8(uint8(currentGoo));
            }

            function changePlayerCurrentGooVials(SerializedGameStateChanges memory self, ZBGameMode.Player player, uint8 gooVials) internal pure {
                SerialityBinaryStream.BinaryStream memory stream = self.stream;

                serializeStartGameStateChangeAction(stream, ZBEnum.GameStateChangeAction.SetPlayerGooVials, player);
                stream.writeUint8(uint8(gooVials));
            }

            function changePlayerCardsInDeck(
                SerializedGameStateChanges memory self,
                ZBGameMode.Player player,
                ZBGameMode.CardInstance[] cards,
                uint cardCount
                ) internal pure {
                require(
                    cardCount <= cards.length,
                    "cardCount > cards.length"
                );

                SerialityBinaryStream.BinaryStream memory stream = self.stream;

                serializeStartGameStateChangeAction(stream, ZBEnum.GameStateChangeAction.SetPlayerCardsInDeck, player);
                stream.writeUint32(uint32(cardCount));

                for (uint i = 0; i < cardCount; i++) {
                    serializeCardInstance(stream, cards[i]);
                }
            }

            function changePlayerCardsInDeck(
                SerializedGameStateChanges memory self,
                ZBGameMode.Player player,
                ZBGameMode.CardInstance[] cards
                ) internal pure {
                changePlayerCardsInDeck(self, player, cards, cards.length);
            }

            function changePlayerCardsInHand(
                SerializedGameStateChanges memory self,
                ZBGameMode.Player player,
                ZBGameMode.CardInstance[] cards,
                uint cardCount
                ) internal pure {
                require(
                    cardCount <= cards.length,
                    "cardCount > cards.length"
                );

                SerialityBinaryStream.BinaryStream memory stream = self.stream;

                serializeStartGameStateChangeAction(stream, ZBEnum.GameStateChangeAction.SetPlayerCardsInHand, player);
                stream.writeUint32(uint32(cardCount));

                for (uint i = 0; i < cardCount; i++) {
                    serializeCardInstance(stream, cards[i]);
                }
            }

            function changePlayerCardsInHand(
                SerializedGameStateChanges memory self,
                ZBGameMode.Player player,
                ZBGameMode.CardInstance[] cards
                ) internal pure {
                changePlayerCardsInHand(self, player, cards, cards.length);
            }

            function changePlayerInitialCardsInHandCount(SerializedGameStateChanges memory self, ZBGameMode.Player player, uint8 count) internal pure {
                SerialityBinaryStream.BinaryStream memory stream = self.stream;

                serializeStartGameStateChangeAction(stream, ZBEnum.GameStateChangeAction.SetPlayerInitialCardsInHandCount, player);
                stream.writeUint8(count);
            }

            function changePlayerMaxCardsInPlay(SerializedGameStateChanges memory self, ZBGameMode.Player player, uint8 count) internal pure {
                SerialityBinaryStream.BinaryStream memory stream = self.stream;

                serializeStartGameStateChangeAction(stream, ZBEnum.GameStateChangeAction.SetPlayerMaxCardsInPlay, player);
                stream.writeUint8(count);
            }

            function changePlayerMaxCardsInHand(SerializedGameStateChanges memory self, ZBGameMode.Player player, uint8 count) internal pure {
                SerialityBinaryStream.BinaryStream memory stream = self.stream;

                serializeStartGameStateChangeAction(stream, ZBEnum.GameStateChangeAction.SetPlayerMaxCardsInHand, player);
                stream.writeUint8(count);
            }

            function changePlayerMaxGooVials(SerializedGameStateChanges memory self, ZBGameMode.Player player, uint8 count) internal pure {
                SerialityBinaryStream.BinaryStream memory stream = self.stream;

                serializeStartGameStateChangeAction(stream, ZBEnum.GameStateChangeAction.SetPlayerMaxGooVials, player);
                stream.writeUint8(count);
            }

            function changePlayerTurnTime(SerializedGameStateChanges memory self, ZBGameMode.Player player, uint32 turnTime) internal pure {
                SerialityBinaryStream.BinaryStream memory stream = self.stream;

                serializeStartGameStateChangeAction(stream, ZBEnum.GameStateChangeAction.SetPlayerTurnTime, player);
                stream.writeUint32(turnTime);
            }

            // SerializedCustomUi

            function init(SerializedCustomUi memory self) internal pure {
                init(self, defaultSerializedCustomUiBufferSize);
            }

            function init(SerializedCustomUi memory self, uint bufferSize) internal pure {
                self.stream = SerialityBinaryStream.BinaryStream(new bytes(bufferSize), bufferSize);
            }

            function getBytes(SerializedCustomUi memory self) internal pure returns (bytes) {
                return self.stream.buffer;
            }

            function add(SerializedCustomUi memory self, ZBGameMode.CustomUiLabel label) internal pure {
                SerialityBinaryStream.BinaryStream memory stream = self.stream;

                serializeStartCustomUiElement(stream, ZBEnum.CustomUiElement.Label, label.rect);
                stream.writeString(label.text);
            }

            function add(SerializedCustomUi memory self, ZBGameMode.CustomUiButton button) internal pure {
                SerialityBinaryStream.BinaryStream memory stream = self.stream;

                serializeStartCustomUiElement(stream, ZBEnum.CustomUiElement.Button, button.rect);
                stream.writeString(button.title);
                stream.writeBytes(button.onClickCallData);
            }

            function serializeStartCustomUiElement(SerialityBinaryStream.BinaryStream memory stream, ZBEnum.CustomUiElement element) private pure {
                stream.writeInt32(int32(element));
            }

            function serializeStartCustomUiElement(
                SerialityBinaryStream.BinaryStream memory stream,
                ZBEnum.CustomUiElement element,
                ZBGameMode.Rect rect
                ) private pure {
                serializeStartCustomUiElement(stream, element);
                serializeRect(stream, rect);
            }

            function serializeRect(SerialityBinaryStream.BinaryStream memory stream, ZBGameMode.Rect rect) private pure {
                serializeVector2Int(stream, rect.position);
                serializeVector2Int(stream, rect.size);
            }

            function serializeVector2Int(SerialityBinaryStream.BinaryStream memory stream, ZBGameMode.Vector2Int v) private pure {
                stream.writeInt32(v.x);
                stream.writeInt32(v.y);
            }
        }
    answer: |
      pragma solidity 0.4.25;

      import "./ZB/ZBGameMode.sol";

      contract ExampleGame is ZBGameMode  {

          function beforeMatchStart(bytes serializedGameState) external {

          }
      }
---

Zombie Battleground ã‚«ã‚¹ã‚¿ãƒ ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ã‚·ã‚§ãƒ«ã¯ã€å³ã«ã‚ã‚‹ã‚ˆã†ã«
Solidity ã§æ›¸ã‹ã‚ŒãŸä»–ã®ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¨åŒã˜ã‚ˆã†ã«å§‹ã¾ã‚‹ã€‚

ã¾ãšæ³¨æ„ã™ã¹ãã¯ã€æˆ‘ã€…ã¯`ZBGameMode.sol`ã¨ã„ã†åå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ãŠ
ã‚Šã€ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚`ZBSerializer.sol`ã¨ãã®ä»–ã„ãã¤ã‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ã„
ã‚‹ã¨ã„ã†ã“ã¨ã ã€‚

> æ³¨: ã“ã‚Œã‚‰ãã®ä»–ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­ã«ã¯ã€éå¸¸ã«ã‚µã‚¤ã‚ºã®å¤§ãã„ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚ãã®ãŸ
> ã‚ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ãã‚Œã‚‰ã‚’å«ã‚ã‚‹ã“ã¨ã¯ã—ã¦ã„ã¾ã›ã‚“ã€‚ã‚½ãƒ¼ã‚¹å®Œå…¨ç‰ˆã«
> ã¯<a href="https://github.com/loomnetwork/zb_game_mode" target=_blank>ã“ã¡ã‚‰ã®
> github ãƒªãƒã‚¸ãƒˆãƒª</a>ã‚ˆã‚Šã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ãŸã ã‘ã¾ã™ã€‚ã—ã‹ã—ã“ã‚Œã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚³ãƒ³
> ãƒ†ãƒ³ãƒ„ã‚’èª­ã‚“ã§ç†è§£ã—ã‚ˆã†ã¨ã”å¿ƒé…ã„ãŸã ãå¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã‚«ã‚¹ã‚¿ãƒ ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰
> ä½œæˆã«å¿…è¦ãªé–¢é€£çŸ¥è­˜ã‚’ã“ã‚Œã‹ã‚‰èª¬æ˜ã—ã¦ã„ãã¾ã™ã€‚

æˆ‘ã€…ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆ`ExampleGame`ã¯`ZBGameMode`ã‚’ç¶™æ‰¿ã—ã¦ã„ã‚‹ã€‚ã ã‹ã‚‰ãŸãã•ã‚“ã®å…±
é€šã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã¨ãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã®ã ã€‚ã‚«ã‚¹ã‚¿ãƒ ã‚²ãƒ¼ãƒ é–‹
ç™ºè€…ã¨ã—ã¦ã®ãŠä¸»ã®æ—¥ã€…ã‚’ã‚¤ãƒ¼ã‚¸ãƒ¼ã«ã™ã‚‹ãŸã‚ã«ã€ã“ã‚Œã‚‰ã‚’ä½œæˆã—ã¦ãŠã„ãŸã‹ã‚‰ãªã€‚

ãã‚Œã¨æˆ‘ã€…ã¯ã“ã‚Œã‚’ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«æŠ½è±¡åŒ–ã—ã¦ãŠã„ãŸã‹ã‚‰ã€å„ã‚«ã‚¹ã‚¿ãƒ ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã«åŒã˜
å®šå‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’æ›¸ãå¿…è¦ã¯ãªã„ã€‚

### "ãƒ•ãƒƒã‚¯" â€” ã‚«ã‚¹ã‚¿ãƒ ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã®æ ¸å¿ƒ

å…¨ã¦ã®ã‚«ã‚¹ã‚¿ãƒ ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã«ã¨ã£ã¦æœ€åˆã®ã‚¹ãƒ†ãƒƒãƒ—ã¨ãªã‚‹ã®ã¯ã€å°‘ãªãã¨ã‚‚ï¼‘ã¤ã®
**_ãƒ•ãƒƒã‚¯_** ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã ã€‚

ã‚³ã‚¢ã®ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ã¯åŸºæœ¬çš„ã«ã€ã‚³ãƒ¼ãƒ‰ã«ã‚ã‚Œã°ã‚²ãƒ¼ãƒ ã®ã‚ã‚‹éƒ¨åˆ†ã«ãŠã„ã¦ã‚ã‚‹é–¢æ•°ã‚’
ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‹ã‚‰æ¢ã—å‘¼ã³å‡ºã™ã€‚

ä¾‹ãˆã°ã€`beforeMatchStart`ã¯å¯¾æˆ¦ãŒã‚¹ã‚¿ãƒ¼ãƒˆã™ã‚‹å‰ã«ã®ã¿å‘¼ã³å‡ºã•ã‚Œ
ã€`afterInitialDraw`ã¯ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæœ€åˆã®ã‚«ãƒ¼ãƒ‰ã‚’å¼•ã„ãŸå¾Œã™ãå‘¼ã³å‡ºã•ã‚Œã‚‹
ã€‚`beforeTurnStart` _(è¨ˆç”»ã—ã¦ã„ã‚‹ãŒæœªå®Ÿè£…)_ ã¯å„ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã‚¿ãƒ¼ãƒ³ã‚¹ã‚¿ãƒ¼ãƒˆæ™‚ã«
ç™ºå‹•ã™ã‚‹ã€‚

ã“ã‚Œã‚‰ã®ãƒ•ãƒƒã‚¯ã¯ã€ã‚²ãƒ¼ãƒ ãŒç¶šãã‚’å§‹ã‚ã‚‹å‰ã«ãŠä¸»ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’é©ç”¨ã—ã€ãã®æ™‚ç‚¹
ã§ã®ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚’ã€Œåˆ©ç”¨ã€ã—ã¦ç·¨é›†ã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã™ã‚‹ã®ã ã€‚

æˆ‘ã€…ãŒå®Ÿè£…ã™ã‚‹æœ€åˆã®ãƒ•ãƒƒã‚¯ã¯`beforeMatchStart`ã¨ã„ã†ã‚‚ã®ã ã€‚ã“ã‚Œã¯ãã®åå‰ã®ç¤ºã™
ã¨ãŠã‚Šã€å„å¯¾æˆ¦ã®ã‚¹ã‚¿ãƒ¼ãƒˆå‰ã«é©ç”¨ã•ã‚Œã‚‹ãƒ•ãƒƒã‚¯ã ã€‚

ã“ã®é–¢æ•°å®šç¾©ã¯ã“ã‚“ãªæ„Ÿã˜ã :

```
function beforeMatchStart(bytes serializedGameState) external {
    // ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã¸ã®å¤‰æ›´ã‚’ã“ã“ã§å®šç¾©
}
```

ã“ã®é–¢æ•°å†…ã§ã€å¯¾æˆ¦ã‚¹ã‚¿ãƒ¼ãƒˆæ™‚ã«é©ç”¨ã—ãŸã„ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ã¸ã®ã‚«ã‚¹ã‚¿ãƒ å¤‰æ›´ã®å…¨ã¦ã‚’å®š
ç¾©ã™ã‚‹ã®ã ã€‚

ã“ã‚Œã‚‰ã®å¤‰æ›´ã¨ã„ã†ã®ã¯ã€å€‹åˆ¥ã®ã‚«ãƒ¼ãƒ‰ã®ãƒãƒ©ãƒ³ã‚¹å¤‰æ›´ã¨ã‹ã€ã©ã®ã‚«ãƒ¼ãƒ‰ãŒã“ã®ã‚²ãƒ¼ãƒ ãƒ¢
ãƒ¼ãƒ‰ã§è¨±å¯/ç¦æ­¢ã•ã‚Œã‚‹ã‹ã¨ã„ã†ãƒ«ãƒ¼ãƒ«ã€ã•ã‚‰ã«ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã®ä½“åŠ›ã‚„ Goo ãƒœãƒˆãƒ«ã®ã‚¹
ã‚¿ãƒ¼ãƒˆæ•°ã¨ã„ã£ãŸã‚ˆã†ãªã‚‚ã®ã¨ãªã‚‹ã€‚

> Zombie Battleground ã‚’ãƒ—ãƒ¬ã‚¤ã—ãŸã“ã¨ãŒãªãã¦ã€ç”¨èªã®æ„å‘³ãŒã‚ã‹ã‚‰ãªã„ãªã‚‰
> ã€<a href="https://zombiebattleground.io/index.php/Gameplay" target=_blank>Zombie
> Battleground ã®ã‚²ãƒ¼ãƒ ãƒ—ãƒ¬ã‚¤ãƒ«ãƒ¼ãƒ«</a>ã®ç°¡å˜ãªç´¹ä»‹ã‚’èª­ã‚“ã§ã¿ã¾ã—ã‚‡ã†ã€‚

## `bytes serializedGameState`

`beforeMatchStart`ã¯ã€`serializedGameState`ã¨ã„ã†ï¼‘ã¤ã®å¼•æ•°`bytes`ã‚’å—ã‘å–ã‚‹ã€‚

ã“ã‚Œã¯ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ã®ãƒãƒ£ãƒ³ã‚¯ã§ã‚ã‚Šæ‰±ã„ã¥ã‚‰ã„ã€‚ãã—ã¦ã“ã‚Œã¯å…¨ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ãƒ‡ãƒƒã‚­å†…
ã®ã‚«ãƒ¼ãƒ‰ã‚„ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã®ä½“åŠ›ã€å½¼ã‚‰ã®æŒã¤ Goo ãƒœãƒˆãƒ«ã®æ•°ã¨ã„ã£ãŸã‚ˆã†ãª **ç¾åœ¨ã®
ã‚²ãƒ¼ãƒ çŠ¶æ…‹å…¨ã¦** ãŒå«ã¾ã‚Œã¦ãŠã‚Šã€é•·ã„ä¸€è¡Œã«å‡ç¸®ã—ãŸã‚‚ã®ã ã€‚

ã“ã‚“ãªæ„Ÿã˜ã§ã‚ã‚‹:

```
// ã‚ªãƒ¼ãƒã‚¤ã‚¬ãƒ¼ãƒƒ......
00000000000000024765797a6572000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000000000000004467265657a7a6565000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000044a65747465720000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000044f7a6d6f7a697a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700000000000000045a6e6f776d616e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000070000000000000004497a7a65000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000443657262657275730000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000447617267616e7475610000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000908000000000000000244656661756c743200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000000002011400000000000000025a68616d70696f6e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000000004466972652d4d6177000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000044d6f646f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000004576572657a6f6d620000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000443796e6465726d616e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009000000000000000442757272726e6e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000700000000000000045175617a69000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500000000000000045079726f6d617a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000708000000000000000144656661756c7431000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000010114000000000000000005
```

ã“ã®æ‰±ã„è¾›ãã†ãªãƒã‚¤ãƒˆé…åˆ—ã‚’å—ã‘å–ã£ãŸã‚‰ã€ã“ã‚Œã‚’æ‰±ã„ã‚„ã™ã„ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«å¤‰æ›ã™ã‚‹
ã®ã ãŒã€ãã‚Œã¯æ¬¡ã®ãƒãƒ£ãƒ—ã‚¿ãƒ¼ã§ã‚„ã£ã¦ã„ã“ã†ã€‚

ãƒ‡ãƒ¼ã‚¿ãŒäººé–“ãŒèª­ã‚ã‚‹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§å—ã‘æ¸¡ã—ã•ã‚Œãšã“ã®ã‚ˆã†ãªã‚„ã‚Šæ–¹ã«ãªã£ã¦ã„ã‚‹ã®ã¯
ã€Zombie Battleground ã‚³ã‚¢ã®ã‚²ãƒ¼ãƒ ã‚³ãƒ¼ãƒ‰ã¨ã‚«ã‚¹ã‚¿ãƒ ã‚²ãƒ¼ãƒ ã‚¹ãƒ†ãƒ¼ãƒˆã®ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆ
ãƒ©ã‚¯ãƒˆã®é–“ã§å¤§é‡ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚„ã‚Šã¨ã‚Šã™ã‚‹ã®ã«ã€ã‹ãªã‚ŠåŠ¹ç‡ã®è‰¯ã„æ–¹æ³•ã§ã‚ã‚‹ã‹ã‚‰ãªã®ã
ã€‚

## ã•ã‚ãƒ†ã‚¹ãƒˆã

1. `beforeMatchStart`ã¨ã„ã†åã®`function`ã‚’å®šç¾©ã›ã‚ˆã€‚ã“ã‚Œã¯ï¼‘ã¤ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼
   ãƒ»`serializedGameState`ã¨ã„ã†åã®`bytes`ã‚’å—ã‘å–ã‚‹ã€‚ã“ã®é–¢æ•°ã¯`external`ã§ãª
   ãã¦ã¯ãªã‚‰ãªã„ã€‚

2. é–¢æ•°æœ¬ä½“ã¯ä»Šã¯ç©ºã®ã¾ã¾ã«ã—ã¦ãŠã‘ã€‚æ¬¡ã®ãƒãƒ£ãƒ—ã‚¿ãƒ¼ã§åŸ‹ã‚ã¦ã„ããã€‚
